---
title: "STAT 331 Portfolio"
author: "Fisher Fraley"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an B.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1

# From Lab 2, Question 1
surveys <- read_csv(here::here("Week 2", "data", "surveys.csv"))


```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2

#Lab 3, Ques 2
teacher_evals <- read_csv(here::here("Week 3", "Data", "teacher_evals.csv"))
```

-   `xlsx`

```{r}
#| label: wd-1-xlsx

#PA 4 Data Import
library(readxl)
military <- read_xlsx("gov_spending_per_capita.xlsx",
                      sheet = ,
                      skip  = ,
                      n_max = ,
                      na = c()
                      )

```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1

#Lab 3, Ques 5
teacher_evals_clean <- teacher_evals |>
  rename(sex = gender) |>
  filter(no_participants > 9) |>
  mutate(
    teacher_id = as.character(teacher_id),
    course_id = as.character(course_id)) |>
  select(
    course_id, teacher_id, question_no, 
    no_participants, resp_share, SET_score_avg, 
    percent_failed_cur, academic_degree, seniority, sex)


```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2

#Challenge 4
ca_childcare_long <- ca_childcare |>
  pivot_longer(
    cols = mc_infant:mfcc_preschool,
    names_to = c("setting_raw", "age_group"),
    names_pattern = "m(c|fcc)_(infant|toddler|preschool)",
    values_to = "median_price"
  ) |>
  mutate(
    setting = recode(setting_raw, "c" = "Center-based", "fcc" = "Family"),
    age_group = factor(age_group, levels = c("infant", "toddler", "preschool")),
    year = as.integer(study_year)
  ) |>
  select(-setting_raw)

ca_childcare_long


```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3

#Challenge 4
ca_childcare <- counties |>
  filter(state_abbreviation == "CA") |>
  left_join(y = childcare_costs, 
             by = join_by(county_fips_code == county_fips_code)) |>
  select(county_fips_code, county_name, study_year, starts_with("mc_"), starts_with("mfcc_"))


```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1

#Lab 3, Ques 9
teacher_evals_clean |>
  group_by(course_id, teacher_id) |>
  summarize(num_q = n_distinct(question_no)) |>
  filter(num_q == 9) |>
  nrow()

```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-2

#Lab 3, Q10
avg_rat_5 <- teacher_evals_clean |>
  filter(question_no == 901) |>
  group_by(teacher_id) |>
    summarize(
      avg_rat = mean(SET_score_avg, na.rm = TRUE),
      n_courses = n_distinct(course_id)
  ) |>
  filter(n_courses >= 5) 
  
avg_rat_5 |>
  slice_max(avg_rat)
```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character

#Lab 3, Q12
ques_12 <- teacher_evals_clean |>
  filter(academic_degree %in% c("dr", "prof")) |>
  group_by(teacher_id) |> 
  summarize(
    avg_resp   = mean(resp_share, na.rm = TRUE),
    sex       = dplyr::first(na.omit(sex)),
    seniority = dplyr::first(na.omit(seniority)),
    .groups = "drop"
  ) |>
  filter(!is.nan(avg_resp)) |>
  mutate(avg_resp_pct = round(100 * avg_resp, 1))

```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string


#Lab 5, Filtering persons based on address and name from crime report.
witness1 <- person |>
  filter(address_street_name == "Northwestern Dr")
witness2 <- person |>
  filter(address_street_name == "Franklin Ave" & 
           str_detect(name, "Annabel"))
witnesses <- bind_rows(witness1, witness2)

witnesses
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date

#Lab 5 (Modified)- Finding members who checked in Jan 9th 2018 and have plate number H42W + reading interview of said member.

gym_suspect <- gym_suspect |>
  inner_join(get_fit_now_check_in, by = c("id" = "membership_id")) |>
  mutate(check_in_date = ymd(check_in_date)) |>        
  filter(check_in_date == ymd("2018-01-09")) |>       
  inner_join(person, by = c("person_id" = "id")) |>
  inner_join(drivers_license, by = c("license_id" = "id")) |>
  filter(str_detect(plate_number, "H42W"))

```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1

#Challenge 3, Q1
teacher_evals_compare <- teacher_evals |>
  filter(question_no == 903) |>
  mutate(
   SET_level = if_else(SET_score_avg >= 4, "excellent", "standard"),
   sen_level = case_when(
      seniority <= 4 ~ "junior",
      seniority >= 5 & seniority <= 8 ~ "senior",
      seniority > 8 ~ "very senior"
    )) |>
   select(course_id, SET_level, sen_level)


```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2

#Lab 7 Q3:
fish_file <- fish_file |>
  mutate(trip = if_else(trip == 1, "Trip 1",
                 if_else(trip == 2, "Trip 2", as.character(trip))))




```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1

# Challenge 4 (Modified to change factor to fct_relevel())
ca_childcare_long <- ca_childcare |>
  pivot_longer(
    cols = mc_infant:mfcc_preschool,
    names_to = c("setting_raw", "age_group"),
    names_pattern = "m(c|fcc)_(infant|toddler|preschool)",
    values_to = "median_price"
  ) |>
  mutate(
    setting = factor(setting_raw) |>
      fct_recode(
        "Center-based"      = "c",
        "Family childcare"  = "fcc"
      ),
    age_group = fct_relevel(age_group, "infant", "toddler", "preschool"),
    year = as.integer(study_year)
  ) |>
  select(-setting_raw)

```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2

# Challenge 4 (Modified to change factor to fct_relevel())
ca_childcare_long <- ca_childcare |>
  pivot_longer(
    cols = mc_infant:mfcc_preschool,
    names_to = c("setting_raw", "age_group"),
    names_pattern = "m(c|fcc)_(infant|toddler|preschool)",
    values_to = "median_price"
  ) |>
  mutate(
    setting = factor(setting_raw) |>
      fct_recode(
        "Center-based"      = "c",
        "Family childcare"  = "fcc"
      ),
    age_group = fct_relevel(age_group, "infant", "toddler", "preschool"),
    year = as.integer(study_year)
  ) |>
  select(-setting_raw)


```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string

#Lab 5 (Modified) - Filter persons based on address and name from crime report descriptions. 
witnesses <- person |>
  filter(
    address_street_name == "Northwestern Dr" |
      (address_street_name == "Franklin Ave" & str_detect(name, "Annabel"))
  ) |>
  mutate(
    address_street_name_clean = str_replace(address_street_name, "Dr$", "Drive"),
    name_length = str_length(name),
    has_middle_initial = str_detect(name, "\\b[A-Z]\\.")
  )

witnesses



```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date

#Lab 5 (Modified)- Finding members who checked in Jan 9th 2018 and have plate number H42W + reading interview of said member.

gym_suspect <- gym_suspect |>
  inner_join(get_fit_now_check_in, by = c("id" = "membership_id")) |>
  mutate(check_in_date = ymd(check_in_date)) |>        
  filter(check_in_date == ymd("2018-01-09")) |>       
  inner_join(person, by = c("person_id" = "id")) |>
  inner_join(drivers_license, by = c("license_id" = "id")) |>
  filter(str_detect(plate_number, "H42W"))

```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1

#Challenge 4 join
ca_childcare <- counties |>
  filter(state_abbreviation == "CA") |>
  left_join(y = childcare_costs,
            by = join_by(county_fips_code == county_fips_code))


```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right

#Lab 5, Join SQL symphony suspect and suspects who match the description.
final_suspect <- sql_suspect |>
  right_join(potential, by = c("person_id" = "id")) |>
  select(name, height, hair_color, car_make, car_model)

```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2

#Lab 5 (Modified a inner join to make a left join), After some quick investigations 
#it turns out Jeremy Bowers was hired...
potential <- person |>
  left_join(drivers_license, by = c("license_id" = "id")) |>
  filter(height >= 65, height <= 67,
         hair_color == "red",
         car_make == "Tesla", car_model == "Model S")

```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1

#Lab 5, Finding members who checked in Jan 9th 2018 and have plate number H42W + reading interview of said member.

gym_suspect <- gym_suspect |>
  inner_join(get_fit_now_check_in, by = c("id" = "membership_id")) |>
  filter(check_in_date == 20180109) |>                 # Jan 9
  inner_join(person, by = c("person_id" = "id")) |>
  inner_join(drivers_license, by = c("license_id" = "id")) |>
  filter(str_detect(plate_number, "H42W"))
gym_suspect

```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2

#Lab 5, Join SQL symphony suspect and suspects who match the description.
final_suspect <- potential |>
  inner_join(sql_suspect, by = c("id" = "person_id")) |>
  select(name, height, hair_color, car_make, car_model)
final_suspect


```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi

#Lab 5 Join witnesses and interview with person_id key 
interviews <- interview |>
  semi_join(witnesses, by = c("person_id" = "id")) |>
  select(person_id, transcript)
interviews




```

-   `anti_join()`

```{r}
#| label: wd-6-anti

#Lab 5, Modified to demonstrate anti_join and rule out suspects.

# gold 48Z members
gym_suspect <- get_fit_now_member |>
  filter(membership_status == "gold",
         str_detect(id, "^(48Z)"))

# who did NOT check in on Jan 9, 2018?
no_jan9_checkin <- gym_suspect |>
  anti_join(
    get_fit_now_check_in |> filter(check_in_date == 20180109),
    by = c("id" = "membership_id")
  )

no_jan9_checkin
```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long

#Challenge 4, Table summary
ca_childcare_long <- ca_childcare |>
  pivot_longer(
    cols = mc_infant:mfcc_preschool,
    names_to = c("setting_raw", "age_group"),
    names_pattern = "m(c|fcc)_(infant|toddler|preschool)",
    values_to = "median_price"
  )

```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide

#Lab 4, Q5
median_region <- ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(region, study_year) |>
  summarise(
    median_income = median(mhi_2018, na.rm = TRUE),
    .groups = "drop"
  ) |>
  pivot_wider(
    names_from = study_year,
    values_from = median_income,
    names_prefix = "year_"
  ) |>
  rename(
    median_income_2008 = year_2008,
    median_income_2018 = year_2018
  ) |>
  arrange(desc(median_income_2018))

```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Example 1 - Challenge 4
-   Example 2 - Lab 2
-   Example 3 - Lab 4
-   Example 4 - Lab 7
-   Example 5 - Challenge 7

All follow this YAML format:\

```{r}
title: "Lab 4: Childcare Costs in California"
author: "Fisher Fraley"
date: "10/9/2025"
format: 
  html: 
    code-fold: true
    toc: true
    theme: litera
    embed-resources: true
code-tools: true
execute: 
  warning: false
  eval: true
  error: true
  echo: true
  editor: source
```

------------------------------------------------------------------------

------------------------------------------------------------------------

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1

##| label: medium-option-colors

# Challenge 2
# Boxplot of rodent weight by species and sex
ggplot(data = surveys, aes(x = weight, y = species, color = sex)) +
  geom_boxplot(outlier.shape = NA, width = 0.6) +  # boxplots
  geom_jitter(width = 0.15, alpha = 0.3, size = 1) +  # individual points
  scale_color_manual(values = tron_colors) +  # custom colors
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # angled labels
  labs(
    title = "Rodent Weight by Species",
    subtitle = "Rodent Species",
    x = "Rodent Weight (g)",
    y = NULL,
    caption = "Source: Portal Project Database"
  )

```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2

##| label: teacher-course-asked-every-question

# Lab 3, Q5
# Count courses with all 9 evaluation questions
teacher_evals_clean |>
  group_by(course_id, teacher_id) |>  # group by course and teacher
  summarise(num_q = n_distinct(question_no)) |>  # count unique questions
  filter(num_q == 9) |>  # keep complete sets
  nrow()  # number of qualifying courses


```

-   Example of function formatting

```{r}
#| label: r-2-3

#Lab 7, Q4
rescale_01 <- function(vect) {
  if (!is.numeric(vect)) { # Check that input is numeric
    stop("`vect` must be numeric.", call. = FALSE)
  }
  if (length(vect) <= 1) { # Check that input length > 1
    stop("`vect` must have more than one value.", call. = FALSE)
  }
  # Carry on
  rng <- range(vect, na.rm = TRUE)
  (vect - rng[1]) / (rng[2] - rng[1])
}

```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example

#Lab 7, Q4
rescale_01 <- function(vect) {
  if (!is.numeric(vect)) { # Check that input is numeric
    stop("`vect` must be numeric.", call. = FALSE)
  }
  if (length(vect) <= 1) { # Check that input length > 1
    stop("`vect` must have more than one value.", call. = FALSE)
  }
  # Carry on
  rng <- range(vect, na.rm = TRUE)
  (vect - rng[1]) / (rng[2] - rng[1])
}
```

-   Example (function stops)

```{r}
#| label: r-3-function-stops

#Challenge 7, Q3
fix_to_na <- function(vect, min, max) {
  
  if (!is.numeric(vect)) { # Check that vect is numeric
    stop("`vect` must be numeric.", call. = FALSE)
  }
  if (!is.numeric(min)) { # Check that min is numeric
    stop("`min`  must be numeric.", call. = FALSE)
  }
  if (!is.numeric(max)) { # Check that max is numeric
    stop("`max` must be numeric.", call. = FALSE)
  }
  case_when(
    vect < min ~ NA_real_,
    vect > max ~ NA_real_,
    TRUE ~ vect
  )
}
```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num

# From Lab 2, Ques 4
ggplot(data = surveys,
       mapping = aes(x = weight, y = hindfoot_length)) +
  geom_point(alpha = .3) +
  facet_wrap(~species) +
  labs(
    title = "Hindfoot Length by Weight For Different Species of Rodents",
    x = "Weight (grams)",
    y = NULL,
    subtitle = "Y-Axis = Hindfoot length (mm)", 
    caption = "Source: Portal Project Database"
  )

```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat

# From Lab 7, Ques 3

# Rainbow Trout Color Pallete: https://www.color-hex.com/color-palette/1024087
trout_palette <- c("#268612","#21a1cf", "#e33d79", "#d0c8c8", "#46b415")

missing_fish |>
  ggplot(aes(x = factor(year), fill = factor(section))) +
  geom_bar(position = "dodge") +
  
  facet_wrap(~trip) +
  scale_fill_manual(values = trout_palette) +
  labs(
    x = "Year",
    y = "Count of Missing Values",
    fill = "Section",
    title = "Missing Weight Measurements in Fish Data by Year, 
            Section, and Trip (1989 - 2006)",
    subtitle = "Only fish missing weight measurements are shown"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat

#Challenge 7, Q5
# Rainbow Trout Color Pallete: https://www.color-hex.com/color-palette/1024087
trout_palette <- c("#268612","#21a1cf", "#e33d79", "#d0c8c8", "#46b415")

fish_plot <- fish |>
  drop_na(condition_index, species, section, year)

ggplot(fish_plot, aes(year, condition_index, color = species)) +
  geom_point(alpha = 0.35, size = 1.6) +
  geom_smooth(method = "loess", se = TRUE, span = 0.6, linewidth = 1) +  
  facet_wrap(~ section) +
  scale_color_manual(values = trout_palette) +
  coord_cartesian(ylim = c(0, 4)) +
  labs(
    title = "Condition Index (K) Over Time by Section",
    x = "Year", y = "Condition Index (K)", color = "Species") +
  theme_minimal() +
  theme(legend.position = "bottom", strip.text = element_text(face = "bold"))
```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date

#Lab 4, Q7
ggplot(data = median_all_region, aes(x = study_year, y = weekly_price, color = region, group = region)) + 
  geom_point(size = 1.6, alpha = 0.9) + 
  facet_wrap(~age_group, nrow = 1) +
  geom_smooth(method = "loess", se = TRUE, fill = "grey70", alpha = 0.25, linewidth = 1) +
  scale_x_continuous(
    limits = c(2008, 2018),
    breaks = seq(2008, 2018, by = 2),
    expand = c(0, 0)
  ) +
  scale_y_continuous(
    limits = c(100, 500),
    breaks = seq(100, 500, by = 100),
    expand = c(0, 0)
  ) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year",
    y = "Median weekly price",
    color = "California Region"
  ) +
  theme(
    panel.spacing = unit(1.6, "lines")
  )


```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1

#Challenge 7, Q5
ggplot(fish_plot, aes(year, condition_index, color = species)) +
  geom_point(alpha = 0.35, size = 1.6) +
  geom_smooth(method = "loess", se = TRUE, span = 0.6, linewidth = 1) +  
  facet_wrap(~ section) +
  scale_color_manual(values = trout_palette) +
  coord_cartesian(ylim = c(0, 4)) +
  labs(
    title = "Condition Index (K) Over Time by Section",
    x = "Year", y = "Condition Index (K)", color = "Species") +
  theme_minimal() +
  theme(legend.position = "bottom", strip.text = element_text(face = "bold"))

```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2

#Challenge 2 plot (Modified to be accesible for anyones eyes with viridis package):
# I realized my tron colors where not color blind friendly by looking up resources on the web
# and colormatching from the plot. I found a resource called viridis that has color palletes 
# that are all color blind friendly. By using scale_color_viridis_d I incorporated colors 
# accessible to everyones eyes.
library(viridis)

ggplot(data = surveys, aes(x = weight, y = species, color = sex)) +
  geom_boxplot(outlier.shape = NA, width = 0.6) +
  geom_jitter(width = 0.15, height = 0, alpha = 0.3, size = 1) +
  scale_color_viridis_d(option = "D", end = 0.9) +  # discrete viridis palette
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  labs(
    title = "Rodent Weight by Species",
    subtitle = "Y-Axis = Rodent Species",
    x = "Rodent Weight (g)",
    y = NULL,
    caption = "Source: Portal Project Database"
  )

```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3

#Challenge 4 Plot
labs(
  title = "Figure 1: CA Full-Time Median Weekly Childcare Prices (2008–2018)",
  x = "Year", y = "Median Weekly Price ($)", color = "Setting"
) +
theme(
  panel.spacing = unit(1.6, "lines"),
  axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)
)


```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4

#Challenge 4 Plot
ggplot(statewide_by_year, aes(x = year, y = median_price, color = setting, group = setting)) +
  geom_line() +
  facet_wrap(~ age_group) +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = "Figure 1: CA Full-Time Median Weekly Childcare Prices (2008–2018)",
    subtitle = "Median Weekly Price ($)",
    x = "Year",
    y = "Median Weekly Price",
    color = "Setting"
  ) +
  theme(
    panel.spacing = unit(1.6, "lines"),
    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)
  )

```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5

#Lab 4, Q9 modified
median_all_region <- median_all_region |>
  mutate(
    region = fct_reorder2(region, study_year, weekly_price)
  )

ggplot(data = median_all_region, 
       aes(x = study_year, y = weekly_price, color = region, group = region)) + 
  geom_point(size = 1.6, alpha = 0.9) + 
  facet_wrap(~age_group, nrow = 1) +
  geom_smooth(method = "loess", se = TRUE, fill = "grey70", alpha = 0.25, linewidth = 1) +
  scale_x_continuous(
    breaks = seq(2008, 2018, by = 2),
    limits = c(2008, 2018)
  ) +
  scale_y_continuous(
    breaks = seq(100, 500, by = 50),
    labels = scales::dollar_format(accuracy = 1),
    limits = c(100, 500)
  ) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year",
    y = "Median Weekly Price",
    color = "California Region"
  ) +
  theme_minimal()

```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1

#Challenge 2 Plot
tron_colors <- c("#DF7212", "#6FC3DF", "#E6FFFF", "#FFE64D", "#0C141F")

ggplot(data = surveys, aes(x = weight, y = species, color = sex)) +
  geom_boxplot(outlier.shape = NA, width = 0.6) +
  geom_jitter(width = 0.15, height = 0, alpha = 0.3, size = 1) +
  scale_color_manual(values = tron_colors) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  labs(
    title = "Rodent Weight by Species",
    subtitle = "Y-Axis = Rodent Species",
    x = "Rodent Weight (g)",
    y = NULL,
    caption = "Source: Portal Project Database"
   )

```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2

#Challenge 7, Q5
trout_palette <- c("#268612","#21a1cf", "#e33d79", "#d0c8c8", "#46b415")

fish_plot <- fish |>
  drop_na(condition_index, species, section, year)

ggplot(fish_plot, aes(year, condition_index, color = species)) +
  geom_point(alpha = 0.35, size = 1.6) +
  geom_smooth(method = "loess", se = TRUE, span = 0.6, linewidth = 1) +  
  facet_wrap(~ section) +
  scale_color_manual(values = trout_palette) +
  coord_cartesian(ylim = c(0, 4)) +
  labs(
    title = "Condition Index (K) Over Time by Section",
    x = "Year", y = "Condition Index (K)", color = "Species") +
  theme_minimal() +
  theme(legend.position = "bottom", strip.text = element_text(face = "bold"))

```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2

# Lab 4 Q8, uses geom_text to display the top 3 counties
ques_8 <- ca_childcare |>
filter(study_year == 2018, !is.na(mhi_2018), !is.na(mc_infant))

label_pts <- ques_8 |>
  slice_max(mc_infant, n = 3)

ggplot(data = ques_8, aes(x = mhi_2018, y = mc_infant)) + 
  geom_point(aes(color = region)) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  geom_text(
    data = label_pts,
    aes(label = county_name),
    vjust = -0.5, size = 3,
    show.legend = FALSE
  ) +
  labs(
    title = "Relationship Between Median Household Income 
    and Infant Childcare Price in California (2018)",
    x = "Median Household Income (2018 dollars)",
    y = "Median Weekly Infant Care Price (Center-Based)"
  ) +
  theme_minimal()

```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3

#Replicated Challenge 4 with geom_ribbon()
ggplot(statewide_by_year, aes(x = year, y = median_price, color = setting, group = setting)) +
  geom_ribbon(
    aes(ymin = lower, ymax = upper, fill = setting),
    alpha = 0.2, color = NA
  ) +
  geom_line(linewidth = 1) +
  facet_wrap(~age_group, nrow = 1) +
  labs(
    title = "CA Full-Time Median Weekly Childcare Prices (2008–2018)",
    x = "Year",
    y = "Median Weekly Price ($)",
    color = "Setting",
    fill = "Setting"
  ) +
  theme_minimal() +
  theme(
    panel.spacing = unit(1.6, "lines"),
    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)
  )
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize

#Lab 3, Q6
teacher_evals_clean <- teacher_evals |>
  rename(sex = gender) |>
  filter(no_participants > 9) |>
  mutate(
    teacher_id = as.character(teacher_id),
    course_id = as.character(course_id)) |>
  select(
    course_id, teacher_id, question_no, 
    no_participants, resp_share, SET_score_avg, 
    percent_failed_cur, academic_degree, seniority, sex)

teacher_evals_clean |>
  summarize(
    unique_teachers = n_distinct(teacher_id),
    unique_courses = n_distinct(course_id)
  )

```

-   Example using `across()`

```{r}
#| label: dvs-4-across

#Lab 4, Q8 (Modified to use across function)
statewide_by_year <- ca_childcare_long |>
  group_by(year, setting, age_group) |>
  summarise(
    across(
      .cols = median_price,
      .fns = list(
        lower = ~quantile(.x, 0.25, na.rm = TRUE),
        median = ~median(.x, na.rm = TRUE),
        upper = ~quantile(.x, 0.75, na.rm = TRUE)
      )
    ),
    .groups = "drop"
  )

```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1

#Lab 3, Q12
ques_12 <- teacher_evals_clean |>
  filter(academic_degree %in% c("dr", "prof")) |>
  group_by(teacher_id) |>
  summarize(
    avg_resp = mean(resp_share, na.rm = TRUE),
    ...
  )



```

-   Example 2

```{r}
#| label: dvs-5-2

#Lab 4, Q8 (Modified to use across function)
statewide_by_year <- ca_childcare_long |>
  group_by(year, setting, age_group) |>
  summarise(
    across(
      .cols = median_price,
      .fns = list(
        lower = ~quantile(.x, 0.25, na.rm = TRUE),
        median = ~median(.x, na.rm = TRUE),
        upper = ~quantile(.x, 0.75, na.rm = TRUE)
      )
    ),
    .groups = "drop"
  )

```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1


#Lab 10 Q2, 
summary <- res_df |>
  count(matches) |>
  mutate(props = n / sum(n))

summary_tbl <- summary |>
  gt() |>
  fmt_percent(columns = props, decimals = 1) |>
  cols_label(
    matches = "Number of Matches",
    n = "Count",
    props = "Proportion"
  )

```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2

#Lab 9 Q3
surveys |>
  map_chr(~ class(.x)[1]) |>
  enframe(name = "Variable", value = "Data Type") |>
  mutate(`Data Type` = stringr::str_to_lower(`Data Type`)) |>
  arrange(Variable) |>
  gt() |>
  tab_header(
    title = md("**Table 1. Data Types of Variables in the `surveys` Dataset**"),
    subtitle = "Each variable’s R data type, arranged alphabetically"
  ) |>
  cols_label(
    Variable = md("**Variable**"),
    `Data Type` = md("**Data Type**")
  ) |>
  tab_options(table.font.size = px(13))

```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3

#Lab 9 Q6
tbl <- evals |>
  select(academic_degree, sen_level, sex) |>
  pivot_longer(everything(), names_to = "demographic", values_to = "group") |>
  mutate(
    demographic = recode(demographic,
      "academic_degree" = "Academic Degree",
      "sen_level"       = "Seniority",
      "sex"             = "Sex"
    )
  ) |>
  filter(!is.na(group)) |>
  count(demographic, group, name = "Count") |>
  group_by(demographic) |>
  mutate(Percent = Count / sum(Count)) |>
  ungroup() |>
  # ordering group names
  mutate(
    demographic = factor(demographic, levels = c("Seniority","Sex","Academic Degree")),
    group = factor(group,
      levels = c("junior","senior","very senior","Female","Male",
                 "No Degree","Masters","Doctorate","Tenured Professor"))
  ) |>
  arrange(demographic, group)

tbl_display <- tbl |>
  mutate(Percent = percent(Percent, accuracy = 0.1))

kb <- tbl_display |>
  # rename columns for the table
  rename(
    Demographic = demographic,
    Group    = group,
    `%`      = Percent
  ) |>
  kable(
    caption   = "Demographics of Professors: Student Evaluations from Warsaw, Poland 2020",
    col.names = c("Demographic", "Group", "Count", "%"),
    align     = c("l", "l", "r", "r")
  ) |>
  kable_styling(
    full_width        = FALSE,
    bootstrap_options = c("striped", "condensed")
  ) |>
  # header that spans Count and %
  add_header_above(c(" " = 2, "Professor" = 2)) |>
  # visually group rows by Demographic
  collapse_rows(columns = 1)

```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1

#Challenge 2 Plot
tron_colors <- c("#DF7212", "#6FC3DF", "#E6FFFF", "#FFE64D", "#0C141F")

ggplot(data = surveys, aes(x = weight, y = species, color = sex)) +
  geom_boxplot(outlier.shape = NA, width = 0.6) +
  geom_jitter(width = 0.15, height = 0, alpha = 0.3, size = 1) +
  scale_color_manual(values = tron_colors) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  labs(
    title = "Rodent Weight by Species",
    subtitle = "Y-Axis = Rodent Species",
    x = "Rodent Weight (g)",
    y = NULL,
    caption = "Source: Portal Project Database"
   )

```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2

#Lab 4, Q5
median_region <- ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(region, study_year) |>
  summarise(
    median_income = median(mhi_2018, na.rm = TRUE)
  ) |>
  pivot_wider(
    names_from = study_year,
    values_from = median_income,
    names_prefix = "year_"
  ) |>
  arrange(desc(year_2018))


```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call

#Lab 8, Q2
pivot_table <- function(df, row_var, col_var){
    df |>
    count({{ row_var }}, {{ col_var }}) |>
    pivot_wider(
      names_from = {{ col_var }},
      values_from = n,
      values_fill = 0
    ) |>
    janitor::adorn_totals(where = c("row", "col"))
}



```

-   using `across()`

```{r}
#| label: pe-1-across

#Lab 8 Q1
rescale_column <- function(df, cols) {
  df |>
    mutate(
      across(
        .cols = {{ cols }},
        .fns = rescale_01
      )
    )
}

```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1

#Lab 9 Q3
surveys |>
  map_chr(~ class(.x)) |>
  enframe(name = "Variable", value = "Data Type") |>
  mutate(`Data Type` = stringr::str_to_lower(`Data Type`)) |>
  arrange(Variable) |>
  gt() |>
  tab_header(
    title = md("**Table 1. Data Types of Variables in the `surveys` Dataset**"),
    subtitle = "Each variable’s R data type, arranged alphabetically"
  ) |>
  cols_label(
    Variable = md("**Variable**"),
    `Data Type` = md("**Data Type**")
  ) |>
  tab_options(table.font.size = px(13))

```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1

#Lab 8 first code
rescale_01 <- function(vect) {
  if (!is.numeric(vect)) { # Check that input is numeric
    stop("`vect` must be numeric.", call. = FALSE)
  }
  if (length(vect) <= 1) { # Check that input length > 1
    stop("`vect` must have more than one value.", call. = FALSE)
  }
  # Carry on
  rng <- range(vect, na.rm = TRUE)
  (vect - rng[1]) / (rng[2] - rng[1])
}

```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2

#Lab 8 Q1
rescale_column <- function(df, cols) {
  df |>
    mutate(
      across(
        .cols = {{ cols }},
        .fns = rescale_01
      )
    )
}

```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3

#Lab 8 Create a table function
pivot_table <- function(df, row_var, col_var){
    df |>
    count({{ row_var }}, {{ col_var }}) |>
    pivot_wider(
      names_from = {{ col_var }},
      values_from = n,
      values_fill = 0
    ) |>
    janitor::adorn_totals(where = c("row", "col"))
}


```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across

#Lab 8 Q1 - Better example
rescale_column <- function(df, cols) {
  df |>
    mutate(
      across(
        .cols = {{ cols }},
        .fns = rescale_01
      )
    )
}
#Lab 7 Q1 - use this if 1st is too similar to across() ex in PE-2
missing_summary <- fish_file |>
  summarise(
    across(everything(), ~sum(is.na(.x)), .names = "{.col}_n_missing"),
    rows_with_missing = sum(if_any(everything(), is.na))
  )

```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1

#Lab 9 Q3
surveys |>
  map_chr(~ class(.x)[1]) |>
  enframe(name = "Variable", value = "Data Type") |>
  mutate(`Data Type` = stringr::str_to_lower(`Data Type`)) |>
  arrange(Variable) |>
  gt() |>
  tab_header(
    title = md("**Table 1. Data Types of Variables in the `surveys` Dataset**"),
    subtitle = "Each variable’s R data type, arranged alphabetically"
  ) |>
  cols_label(
    Variable = md("**Variable**"),
    `Data Type` = md("**Data Type**")
  ) |>
  tab_options(table.font.size = px(13))
```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2

#Lab 9 - Q7
fish |>
  map_int(~ sum(is.na(.x))) |>   
  enframe(name = "Variable", value = "Missing Values") |>
  kable(
    caption = "Number of Missing Values per Variable in the Fish Dataset",
    col.names = c("Variable", "Missing Values")
  ) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "condensed"))

```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1

#Lab 10 Q8 using lm()

mycifun <- function(beta0, beta1, n) {

  # Generate Synthetic Data
  x <- runif(n, min = 0, max = 1)
  ep <- rnorm(n, mean = 0, sd = 1) 
  y <- beta0 + (beta1 * x) + ep
  
  observed_data <- tibble(x = x, y = y)
  
  # Fit lm model
  model_fit <- lm(y ~ x, data = observed_data)
  
  # Get Results + Check pop slope is contained within 95 CI
  output <- tidy(model_fit, conf.int = TRUE, conf.level = 0.95) |>
    filter(term == "x") |>
    mutate(cover = if_else(conf.low <= beta1 & beta1 <= conf.high, 1, 0)) |>
    select(estimate, conf.low, conf.high, cover)
  
 return(output) 
}

```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2

# Lab 7 Q3
missing_fish |>
  ggplot(aes(x = factor(year), fill = factor(section))) +
  geom_bar(position = "dodge") +
  
  facet_wrap(~trip) +
  scale_fill_manual(values = trout_palette) +
  labs(
    x = "Year",
    y = "Count of Missing Values",
    fill = "Section",
    title = "Missing Weight Measurements in Fish Data by Year, 
            Section, and Trip (1989 - 2006)",
    subtitle = "Only fish missing weight measurements are shown"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1

#Lab 10, Q1

set.seed(333) #Lucky number is 3 so 3 threes :)

randomBabies <- function(n_babies){
  simulation_data <- tibble(
    parent = 1:n_babies,
    returned_baby = sample(1:n_babies) 
  )

res <- simulation_data |>
    # Get # of returned babies correctly returned babies per sim
    summarize(matches = sum(parent == returned_baby)) |>
    pull(matches)

return(res)
}
# 1 - 10,000 simulations
results <- map_int(.x = 1:10000,
                   .f = ~ randomBabies(n_babies = 4)
                  )

```

-   Example 2

```{r}
#| label: dsm-1-2

#Lab 10, Q9
ci_dat <- map(.x = 1:1000,
              .f = ~ mycifun(beta0 = 3, beta1 = .5, n = 100)
              )

```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

**Feedback: I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable.**

-   Removed nested functions

```{r}
#| label: dsm-2-1

#Challenge 3, Q3
chisq.test(teacher_evals_compare$SET_level, teacher_evals_compare$sen_level)


```

-   Example 2

```{r}
#| label: dsm-2-2


#Lab 2, Ques 17
summary(aov(weight ~ species, data = surveys))


```

-   Example 3

```{r}
#| label: dsm-2-3

#Lab 4, Q9
reg_mod1 <- lm(mc_infant ~ mhi_2018, data = subset(ca_childcare, study_year == 2018))
summary(reg_mod1)

```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

Throughout this course, I really took the time to rethink my approach. I found that slowing down and fully grasping the tools I was using made a big difference, as opposed to just jumping into coding without a second thought. In the beginning, I often dived straight into packages like dplyr and lubridate without truly understanding how each function worked. However, as the semester progressed, I realized the value of looking up documentation and examples online before using new functions. This shift allowed me to write cleaner and more purposeful code. I started to care much more about how my tables and visuals looked; I began asking myself whether my plots were understandable to someone else and if someone unfamiliar with the data set could really glean meaningful insights from them. This change in perspective helped me move beyond just producing code that worked to actually communicating my results effectively through visuals and formatting.

<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

For my revisions, I included your feedback in bold text directly above the updated code so that it’s easy to see what I changed and why. For example, in Lab 3, Question 7, I revised a line of code to correctly count degrees by male and female categories after reflecting on my peers' feedback during the code review. This revision really helped me see how to use grouping and filtering more effectively for accurate summaries. By clearly labeling my feedback and including my updated code, I was able to demonstrate my learning process and show how I applied insights from you and my classmates.

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

I've been working on how I present data in my plots and tables to make them more transparent and more engaging. One of the first things I did was rename variables to ensure the labels were straightforward and easy to read. I also experimented with different colors to create visuals that pop without being overwhelming. To improve readability, I adjusted the scales and spacing in my plots so the data points don't feel cramped, making it easier to spot patterns. Additionally, I've been focusing on organizing my code better. While I haven't added many comments yet, I'm planning to incorporate them more consistently in the coming weeks. I think this will help others (and myself!) follow my work more easily. Overall, I'm excited about these improvements and how they'll enhance my data presentation efforts.

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

![](images/clipboard-1399497268.png)

Lab 3\^

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->

Throughout this class, I’ve grown as a collaborator by thinking more intentionally about what my peers can learn from my feedback. Instead of simply saying what I liked or didn’t like, I began giving specific, detailed comments that explained *why* something worked or how it could be improved. This approach helped my partners make immediate changes and learn from the process, while also improving my own understanding as I explained my reasoning.
